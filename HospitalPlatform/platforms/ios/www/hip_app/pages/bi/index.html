<script src="../assets/scripts/show-num.js" type="text/javascript"></script>
  <div class="row" id="update-date" style="border-top:2px solid #FFF;top:63px;">
  	<i class="fa fa-calendar"></i> 当日(09-15)
  </div>
  <div class="row" style="margin-top:50px;">	
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
      <div class="dashboard-stat blue">
        <div class="visual">
          <i class="icon-hospital icon-4x"></i>
        </div>
        <div class="details">
          <div class="number count timer" data-speed="1000" data-to="105.75" style="padding-right:28px;"></div>
          <span style="position:absolute;right:.5em;top:2.5em;color:#FFF;">万元</span>
          <div class="desc">全院收入</div>
        </div>
        <a href="#" class="more text-center" style="font-size:1em;">药品比：41.96%</a>
      </div>
    </div>
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
      <div class="dashboard-stat green">
        <div class="visual">
          <i class="icon-user-md icon-4x"></i>
        </div>
        <div class="details">
          <div class="number count timer" data-speed="1000" data-to="21.03" style="padding-right:28px;"></div>
          <span style="position:absolute;right:.5em;top:2.5em;color:#FFF;">万元</span>
          <div class="desc">门诊收入</div>
        </div>
        <a href="#" class="more text-center" style="font-size:1em;">药品比：43.07%</a>
      </div>
    </div>
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
      <div class="dashboard-stat purple">
        <div class="visual">
          <i class="icon-plus-sign-alt icon-4x"></i>
        </div>
        <div class="details">
          <div class="number count timer" data-speed="1000" data-to="84.72" style="padding-right:28px;"></div>
          <span style="position:absolute;right:.5em;top:2.5em;color:#FFF;">万元</span>
          <div class="desc">住院收入</div>
        </div>
        <a href="#" class="more text-center" style="font-size:1em;">药品比：41.69%</a>
			</div>
    </div>
  </div>

  
  <div class="row">
  	<div class="col-md-6 col-sm-6 col-xs-12">
      <div class="patient-main-middle-module">
        <span class="title bg_red">当日挂号数量(人次)</span> <span class="num">996</span> <span class="history">30日平均：852</span>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <!-- BEGIN PORTLET-->
      <div class="portlet solid bordered light-grey" style="padding-bottom:0;">
        <div class="portlet-title">
          <div class="caption"><i class="fa fa-line-chart"></i>近1周收入趋势(单位:万元)</div>
          <!--<div class="date-range"><i class="fa fa-calendar"></i> 07-23 ~ 07-29</div>-->
        </div>
        <div class="portlet-body">
          <div id="income_trend_div" class="chart" style="height:220px;"></div>
        </div>
      </div>
      <!-- END PORTLET-->
    </div>
  </div>
  
  <div class="row">
    <div class="col-md-6 col-sm-6 col-xs-12">
  	<!-- BEGIN PORTLET-->
		<div class="portlet">
			<div class="portlet-body">
				<!--BEGIN TABS-->
				<div class="tabbable tabbable-custom">
					<div class="tab-content" style="height:125px;">
						<div class="tab-pane active" id="tab_1_1">
							<table class="table table-hover">
                <tbody>
                  <tr>
                    <th style="border-top:none;">当日在院人数</th>
                    <td class="text-right" style="border-top:none;">776 <i class="fa fa-arrow-up text-red"></i></td>
                  </tr>
                  <tr>
                    <th>当日入院人数</th>
                    <td class="text-right">129 <i class="fa fa-arrow-up text-red"></i></td>
                  </tr>
                  <tr>
                    <th>当日出院人数</th>
                    <td class="text-right">121 <i class="fa fa-arrow-up text-red"></i></td>
                  </tr>
                </tbody>
              </table>
						</div>
					</div>
				</div>
				<!--END TABS-->
			</div>
		</div>
		<!-- END PORTLET-->
    </div>
  </div>

  <div class="row">	
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
      <div class="dashboard-stat red">
        <div class="visual">
          <i class="icon-hospital icon-4x"></i>
        </div>
        <div class="details">
          <div class="number">71%</div>
          <div class="desc">当日床位使用率</div>
        </div>
      </div>
    </div>
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
      <div class="dashboard-stat yellow">
        <div class="visual">
          <i class="icon-hospital icon-4x"></i>
        </div>
        <div class="details">
          <div class="number">36%</div>
          <div class="desc">当日仅用药患者比</div>
        </div>
      </div>
    </div>
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
      <div class="dashboard-stat grey">
        <div class="visual">
          <i class="icon-hospital icon-4x"></i>
        </div>
        <div class="details">
          <div class="number" style="padding-right:28px;">1617</div>
          <span style="position:absolute;right:.5em;top:2.5em;color:#FFF;">万元</span>
          <div class="desc">当前药品库存</div>
        </div>
      </div>
    </div>
  </div>

  
  <div class="row" style="padding-bottom:60px;">
    <div class="col-md-12">
      <!-- BEGIN PORTLET-->
      <div class="portlet paddingless">
        <div class="portlet-body">
          <!--BEGIN TABS-->
          <div class="tabbable tabbable-custom">
            <ul class="nav nav-tabs">
              <li class="active"><a id="income-pie" href="#tab_2_1" data-toggle="tab"><i class="fa fa-leaf"></i> 当日收入构成</a></li>
              <li><a href="#tab_2_2" id="pay-pie" data-toggle="tab"><i class="fa fa-object-group"></i> 当日付款方式比例</a></li>
            </ul>
            <div class="tab-content" style="height:230px;">
              <div class="tab-pane active" id="tab_2_1">
                <div id="income_construct_div" class="chart" style="height:220px;"></div>
              </div>
              <div class="tab-pane" id="tab_2_2">
                <div id="clinic_pay_div" class="chart" style="height:220px;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
 
    
<script>
$(function(){
	incomePie();
	incomeTrend();
	var payPieCheck = 0;
	$("#pay-pie").click(function(){
		if(payPieCheck == 0) {
			payPieCheck = 1;
			window.setTimeout("todayPayPie()",100);//当日付款方式饼图
		}
	});
	$("#update-date").width($(".row:eq(1)").width()-20);
	
	/***********
	$.getJSON('http://192.168.4.220:8080/hip/bi/getJson?sqlId=ALL.FEE.DRUG_PROP',function(data){
		alert(data);
	});
	**************/
	
});
//收入构成
function incomePie() {
	var incomeData = [ {
		"chartKey" : "药品",
		"chartValue" : 44.37,
	}, {
		"chartKey" : "手术",
		"chartValue" : 6.51,
	}, {
		"chartKey" : "检查",
		"chartValue" : 15.01,
	}, {
		"chartKey" : "检验",
		"chartValue" : 11.24,
	}, {
		"chartKey" : "卫材",
		"chartValue" : 16.73,
	}, {
		"chartKey" : "治疗",
		"chartValue" : 4.10,
	}, {
		"chartKey" : "其它",
		"chartValue" : 7.78,
	} ];

	// PIE CHART
	var pie1 = new AmCharts.AmPieChart();
	pie1.dataProvider = incomeData;
	pie1.titleField = "chartKey";
	pie1.valueField = "chartValue";
	pie1.sequencedAnimation = true;
	pie1.startEffect = "elastic";
	pie1.innerRadius = "40%";
	pie1.startDuration = 2;
	pie1.labelRadius = 1;
	pie1.balloonText = "[[title]]<br><span style='font-size:14px'><b>[[value]]</b> 万元 ([[percents]]%)</span>";
	pie1.labelText = "";
	pie1.startDuration = 2;
	pie1.radius = 95;
	pie1.labelRadius = 15;
	pie1.pieX = "30%";
	//pie1.addTitle("收入构成-全院");
	// LEGEND
	legend1 = new AmCharts.AmLegend();
	
	legend1.align = "right";
	//legend1.color = "#FFF";
	legend1.position = "absolute";
	legend1.top = -10;
	legend1.right = 20;
	legend1.borderAlpha = 0;
	legend1.valueWidth = 0.2;
	legend1.horizontalGap = 0;
	legend1.width = 60;
	legend1.valueText = "";
	
	
	pie1.addLegend(legend1);
	
	pie1.write("income_construct_div");
}

//收入趋势
function incomeTrend(){
	var mouthCompData = [{
		"chartKey" : "09-09",
		"inValue" : 70.29,
		"outValue" : 23.63,
		"allValue" : 93.92
	}, {
		"chartKey" : "09-10",
		"inValue" : 72.28,
		"outValue" : 21.52,
		"allValue" : 93.80
	}, {
		"chartKey" : "09-11",
		"inValue" : 69.27,
		"outValue" : 20.19,
		"allValue" : 89.46
	}, {
		"chartKey" : "09-12",
		"inValue" : 77.62,
		"outValue" : 14.62,
		"allValue" : 92.24
	}, {
		"chartKey" : "09-13",
		"inValue" : 62.87,
		"outValue" : 16.63,
		"allValue" : 79.51
	}, {
		"chartKey" : "09-14",
		"inValue" : 70.83,
		"outValue" : 11.52,
		"allValue" : 82.35
	}, {
		"chartKey" : "09-15",
		"inValue" : 84.72,
		"outValue" : 21.03,
		"allValue" : 105.75
	} ];
	// SERIAL CHART
	var mouthCompColumn = new AmCharts.AmSerialChart();
	mouthCompColumn.dataProvider = mouthCompData;
	mouthCompColumn.categoryField = "chartKey";
  
	mouthCompColumn.autoMargins = false;
	mouthCompColumn.marginLeft = 5;
	mouthCompColumn.marginRight = 5;
	mouthCompColumn.marginTop = 0;
	mouthCompColumn.marginBottom = 35;
	 
	// AXES
	// category axis
	var categoryAxis = mouthCompColumn.categoryAxis;
	//categoryAxis.autoGridCount = false;
	//categoryAxis.labelsEnabled = false;
	categoryAxis.gridCount = 0;
	categoryAxis.gridAlpha = 0;
	categoryAxis.gridColor = "#999";
	categoryAxis.axisColor = "#999";
	categoryAxis.labelRotation = 45;
		
	var valueAxis = new AmCharts.ValueAxis();
	valueAxis.gridAlpha = .1;
	valueAxis.axisAlpha = 0;
	mouthCompColumn.addValueAxis(valueAxis);

	//otheryearAxis.inside = true;

	//mouthCompColumn.addValueAxis(otheryearAxis);

	// GRAPHS
	// otheryear graph
	var allGraph = new AmCharts.AmGraph();
	allGraph.title = "全院";
	allGraph.valueField = "allValue";
	allGraph.type = "column";
	//allGraph.valueAxis = otheryearAxis;
	allGraph.legendValueText = "[[value]]";
	allGraph.balloonText = "全院: <b>[[value]]万元</b>";
	allGraph.type = "column";
	allGraph.lineAlpha = 0;
	allGraph.fillAlphas = 0.8;
	allGraph.fillColors = "#CCC"; 
	
	mouthCompColumn.addGraph(allGraph);

	var outGraph = new AmCharts.AmGraph();
	outGraph.title = "门诊";
	outGraph.valueField = "outValue";
	outGraph.type = "line";
	//outGraph.valueAxis = otheryearAxis;
	outGraph.lineColor = "#40BAF4";
	outGraph.balloonText = "门诊：[[value]]万元";
	outGraph.lineThickness = 1;
	outGraph.legendValueText = "[[value]]";
	outGraph.bullet = "round";
	outGraph.bulletBorderColor = "#40BAF4";
	outGraph.bulletBorderAlpha = 1;
	outGraph.bulletBorderThickness = 1;
	mouthCompColumn.addGraph(outGraph);

	var inGraph = new AmCharts.AmGraph();
	inGraph.title = "住院";
	inGraph.valueField = "inValue";
	inGraph.type = "line";
	//inGraph.valueAxis = otheryearAxis;
	inGraph.lineColor = "#78D542";
	inGraph.balloonText = "住院：[[value]]万元";
	inGraph.lineThickness = 1;
	inGraph.legendValueText = "[[value]]";
	inGraph.bullet = "round";
	inGraph.bulletBorderColor = "#78D542";
	inGraph.bulletBorderAlpha = 1;
	inGraph.bulletBorderThickness = 1;
	mouthCompColumn.addGraph(inGraph);

	// CURSOR
	var chartCursor = new AmCharts.ChartCursor();
	chartCursor.zoomable = false;
	chartCursor.cursorAlpha = 0;
	chartCursor.valueLineEnabled = true;
	chartCursor.valueLineBalloonEnabled = true;
	mouthCompColumn.addChartCursor(chartCursor);

	var legend1 = new AmCharts.AmLegend();
	legend1.bulletType = "round";
	legend1.equalWidths = true;
	legend1.valueWidth = 45;
	legend1.color = "#000000";
	legend1.position = "top";
	legend1.useGraphSettings = true;
	mouthCompColumn.addLegend(legend1);

	// WRITE
	mouthCompColumn.write("income_trend_div");
}

function todayPayPie() {
	//当日付款方式饼图Start //目前采用门诊+住院 zjy
	var clinicPayDate = [ {
	  "chartKey" : "自费",
	  "chartValue" : 12280, //11617+663
	  "chartColor" : "#EBFF45"
	}, {
	  "chartKey" : "新农合",
	  "chartValue" : 682,
	  "chartColor" : "#F6FF94"
	}, {
	  "chartKey" : "城镇居民医保", //无数据
	  "chartValue" : 0,
	  "chartColor" : "#F0AB79"
	}, {
	  "chartKey" : "老干部",
	  "chartValue" : 950, //919+31
	  "chartColor" : "#EACC46"
	}, {
	  "chartKey" : "惠民医疗",
	  "chartValue" : 81,
	  "chartColor" : "#D5FF45"
	}, {
	  "chartKey" : "特约优惠",
	  "chartValue" : 128,
	  "chartColor" : "#E9FF43"
	}, {
	  "chartKey" : "宿迁医疗", //原为看守所，改为宿迁医疗 zjy
	  "chartValue" : 144,
	  "chartColor" : "#FAFFB8"
	} ];

	// PIE CHART
	var pie2 = new AmCharts.AmPieChart();
	pie2.dataProvider = clinicPayDate;
	pie2.titleField = "chartKey";
	pie2.valueField = "chartValue";
	pie2.colorField = "chartColor";
	pie2.sequencedAnimation = true;
	pie2.startEffect = "elastic";
	pie2.innerRadius = "40%";
	pie2.startDuration = 2;
	pie2.labelRadius = 1;
	pie2.balloonText = "[[title]]<br><span style='font-size:14px'><b>[[value]]</b> 万元 ([[percents]]%)</span>";
	//pie2.depth3D = 10;
	//pie2.angle = 15;
	pie2.pieX = "30%";
	pie2.labelText = "";
	pie2.startDuration = 2;
	pie2.radius = 95;
	pie2.labelRadius = 15;
	// LEGEND
	legend2 = new AmCharts.AmLegend();
	
	legend2.align = "right";
	//legend1.color = "#FFF";
	legend2.position = "absolute";
	legend2.top = -10;
	legend2.right = 10;
	legend2.borderAlpha = 0;
	legend2.valueWidth = 0.2;
	legend2.horizontalGap = 0;
	legend2.width = 85;
	legend2.valueText = "";
	
	pie2.addLegend(legend2);
	pie2.write("clinic_pay_div");  //当日付款方式饼图End
}

</script>      